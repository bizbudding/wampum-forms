(function(a,n,e){"use strict";function i(a){r(a);var n=a.siblings('form[data-form="login"]');a.fadeOut(300,function(){n.fadeIn(600)}),n.find('input[name="username"]').val(a.find('input[name="email"]').val()),n.find('input[name="password"]').focus(),n.find(".wampum-back").remove(),n.find('button[name="submit"]').after('<a class="wampum-back" href="#">&nbsp;&nbsp;Go back</a>'),n.on("click",".wampum-back",function(e){e.preventDefault(),n.fadeOut(300,function(){a.fadeIn(600)}),n.find('input[name="password"]').val("")})}function s(a){var n=a.substring(a.indexOf("#"));if(n){var e=[location.protocol,"//",location.host,location.pathname].join("");e==t(a)&&(window.location.href+="#"+n,location.reload())}window.location.replace(a)}function t(a){return a.split(/[?#]/)[0]}function o(a,n,e){a.find(".wampum-notice").removeClass("success error").addClass(n).html(e).fadeIn("fast")}function r(a){a.find(".wampum-notice").slideUp("fast",function(){n(this).removeClass("success error")})}function m(){return'<span class="wampum-loading"><span class="wampum-loading-circle wampum-loading-circle1">&#8226;</span><span class="wampum-loading-circle wampum-loading-circle2">&#8226;</span><span class="wampum-loading-circle wampum-loading-circle3">&#8226;</span></span>'}var u=n(".wampum-form"),l=n(".password-strength-meter");n.each(u,function(){var a=n(this).find('input[name="password"]'),e=n(this).find('input[name="password_confirm"]');(a.length&&e.length)>0&&u.on("keyup",e,function(n){var i=a.val(),s=e.val();""!=(i&&s)&&(a.val()==e.val()?a.add(e).css({"border-color":"#25f500"}):a.add(e).css({"border-color":""}))})}),l.length>0&&(u.on("focus",'input[name="password"]',function(a){n(this).closest("form").find(".password-strength").slideDown("fast")}),u.on("keyup",'input[name="password"]',function(a){var e=n(this).closest("form"),i={0:"Weak",1:"Weak",2:"Okay",3:"Good",4:"Great"},s=e.find(".password-strength-meter"),t=e.find(".password-strength-text"),o=n(this).val(),r=zxcvbn(o);s.attr("data-strength",r.score),""!==o?t.html(i[r.score]):t.html("")})),u.on("submit",'form[data-form="login"]',function(a){console.log("Login form submitted"),a.preventDefault();var e=n(this),i=e.find('button[name="submit"]'),t=i.html();e.addClass("processing"),i.prop("disabled",!0),i.html(m()),r(e);var u={user_login:e.find('input[name="username"]').val(),user_password:e.find('input[name="password"]').val(),remember:e.find('input[name="rememberme"]').val(),notifications:e.find('input[name="notifications"]').val(),say_what:e.find('input[name ="say_what"]').val()};n.ajax({method:"POST",url:wampumFormVars.root+"wampum/v1/login/",data:u,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampumFormVars.nonce)},success:function(a){if(1==a.success){o(e,"success","Success!");var n=e.find('input[name="redirect"]').val();""!=n&&("membership_form"==n?window.location.reload():s(n))}else o(e,"error",a.message)}}).fail(function(a){o(e,"error",a.failure)}).done(function(a){e.removeClass("processing"),i.html(t).prop("disabled",!1)})}),u.on("submit",'form[data-form="password"]',function(a){console.log("Password form submitted"),a.preventDefault();var e=n(this),i=e.find('button[name="submit"]'),t=i.html();e.addClass("processing"),i.prop("disabled",!0),i.html(m()),r(e);var u={password:e.find('input[name="password"]').val(),password_confirm:e.find('input[name="password_confirm"]').val(),notifications:e.find('input[name="notifications"]').val(),say_what:e.find('input[name="say_what"]').val()};n.ajax({method:"POST",url:wampumFormVars.root+"wampum/v1/password/",data:u,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampumFormVars.nonce)},success:function(a){if(1==a.success){o(e,"success","Success!");var n=e.find('input[name="redirect"]').val();s(n)}else e.find(".password-strength-meter").attr("data-strength",""),e.find(".password-strength-text").html(""),o(e,"error",a.message)}}).fail(function(a){o(e,"error",wampumFormVars.failure)}).done(function(a){e.removeClass("processing"),i.html(t).prop("disabled",!1)})}),u.on("submit",'form[data-form="register"]',function(a){console.log("Register form submitted"),a.preventDefault();var e=n(this),i=e.find('button[name="submit"]'),t=i.html();i.prop("disabled",!0),i.html(m()),r(e);var u={email:e.find('input[name="email"]').val(),username:e.find('input[name="username"]').val(),first_name:e.find('input[name="first_name"]').val(),last_name:e.find('input[name="last_name"]').val(),password:e.find('input[name="password"]').val(),password_confirm:e.find('input[name="password_confirm"]').val(),log_in:e.find('input[name="log_in"]').val(),ac_list_ids:e.find('input[name="ac_list_ids"]').val(),ac_tags:e.find('input[name="ac_tags"]').val(),notifications:e.find('input[name="notifications"]').val(),say_what:e.find('input[name="say_what"]').val()};n.ajax({method:"POST",url:wampumFormVars.root+"wampum/v1/register/",data:u,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampumFormVars.nonce)},success:function(a){if(1==a.success){o(e,"success","Success!");var n=e.find('input[name="redirect"]').val();s(n)}else o(e,"error",a.message)}}).fail(function(a){o(e,"error",a.failure)}).done(function(a){e.removeClass("processing"),i.html(t).prop("disabled",!1)})}),u.on("submit",'form[data-form="subscribe"]',function(a){console.log("Subscribe form submitted"),a.preventDefault();var e=n(this),i=e.find('button[name="submit"]'),t=i.html();i.prop("disabled",!0),i.html(m()),r(e);var u={email:e.find('input[name="email"]').val(),first_name:e.find('input[name="first_name"]').val(),last_name:e.find('input[name="last_name"]').val(),ac_list_ids:e.find('input[name="ac_list_ids"]').val(),ac_tags:e.find('input[name="ac_tags"]').val(),notifications:e.find('input[name="notifications"]').val(),say_what:e.find('input[name="say_what"]').val()};n.ajax({method:"POST",url:wampumFormVars.root+"wampum/v1/subscribe/",data:u,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampumFormVars.nonce)},success:function(a){if(1==a.success){o(e,"success","Success!");var n=e.find('input[name="redirect"]').val();s(n)}else o(e,"error",a.message)}}).fail(function(a){o(e,"error",a.failure)}).done(function(a){e.removeClass("processing"),i.html(t).prop("disabled",!1)})}),u.on("submit",'form[data-form="user-available"]',function(a){console.log("User available form submitted"),a.preventDefault();var e=n(this),s=e.find('button[name="submit"]');e.addClass("processing");var t=s.html();s.prop("disabled",!0),s.html(m()),r(e);var u={email:e.find('input[name="email"]').val(),username:e.find('input[name="username"]').val(),say_what:e.find('input[name="say_what"]').val(),current_url:wampumFormVars.current_url};n.ajax({method:"POST",url:wampumFormVars.root+"wampum/v1/user-available/",data:u,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampumFormVars.nonce)},success:function(a){if(1==a.success){var n=e.siblings('form[data-form="join-membership"]');n.find('input[name="first_name"]').val(e.find('input[name="first_name"]').val()).prop("readonly",!0),n.find('input[name="last_name"]').val(e.find('input[name="last_name"]').val()).prop("readonly",!0),n.find('input[name="email"]').val(e.find('input[name="email"]').val()).prop("readonly",!0),n.find('input[name="username"]').val(e.find('input[name="username"]').val()).prop("readonly",!0),n.find(".first-name").hide(),n.find(".last-name").hide(),n.find(".email").hide(),n.find(".username").hide(),o(n,"success","Almost there! This is the last step."),e.fadeOut(300,function(){n.fadeIn(600),n.find('input[name="password"]').focus()})}else o(e,"error",a.message),e.on("click",".login-link",function(a){a.preventDefault(),setTimeout(function(){i(e)},300)})}}).fail(function(a){o(e,"error",wampumFormVars.failure)}).done(function(a){e.removeClass("processing"),s.html(t).attr("disabled",!1)})}),u.on("submit",'form[data-form="join-membership"]',function(a){console.log("Membership form submitted"),a.preventDefault();var e=n(this),t=e.find('button[name="submit"]');e.addClass("processing");var u=t.html();t.prop("disabled",!0),t.html(m()),r(e);var l={plan_id:e.find('input[name="plan_id"]').val(),email:e.find('input[name="email"]').val(),first_name:e.find('input[name="first_name"]').val(),last_name:e.find('input[name="last_name"]').val(),username:e.find('input[name="username"]').val(),password:e.find('input[name="password"]').val(),log_in:e.find('input[name="log_in"]').val(),notifications:e.find('input[name="notifications"]').val(),ac_list_ids:e.find('input[name="ac_list_ids"]').val(),ac_tags:e.find('input[name="ac_tags"]').val(),notifications:e.find('input[name="notifications"]').val(),say_what:e.find('input[name="say_what"]').val(),current_url:wampumFormVars.current_url};n.ajax({method:"POST",url:wampumFormVars.root+"wampum/v1/membership-add/",data:l,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampumFormVars.nonce)},success:function(a){if(1==a.success){o(e,"success","Success!");var n=e.find('input[name="redirect"]').val();""!=n?setTimeout(function(){s(n)},300):setTimeout(function(){e.fadeOut("fast")},300)}else o(e,"error",a.message),e.on("click",".login-link",function(a){a.preventDefault(),setTimeout(function(){i($userAvailableForm)},300)})}}).fail(function(a){o(e,"error",wampumFormVars.failure)}).done(function(a){e.removeClass("processing"),t.html(u).prop("disabled",!1)})})})(document,jQuery);