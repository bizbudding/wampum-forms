!function(a,n,s){"use strict";function e(a){o(a);var n=a.siblings('form[data-form="login"]');a.fadeOut(300,function(){n.fadeIn(600)}),n.find('input[name="username"]').val(a.find('input[name="email"]').val()),n.find('input[name="password"]').focus(),n.find(".wampum-back").remove(),n.find('button[name="submit"]').after('<a class="wampum-back" href="#">&nbsp;&nbsp;Go back</a>'),n.on("click",".wampum-back",function(s){s.preventDefault(),n.fadeOut(300,function(){a.fadeIn(600)}),n.find('input[name="password"]').val("")})}function i(a){var n=a.substring(a.indexOf("#"));n&&[location.protocol,"//",location.host,location.pathname].join("")==t(a)&&(window.location.href+="#"+n,location.reload()),window.location.replace(a)}function t(a){return a.split(/[?#]/)[0]}function m(a,n,s){a.find(".wampum-notice").removeClass("success error").addClass(n).html(s).fadeIn("fast")}function o(a){a.find(".wampum-notice").slideUp("fast",function(){n(this).removeClass("success error")})}var r=n(".wampum-form"),l=n(".password-strength-meter");n.each(r,function(){var a=n(this).find('input[name="password"]'),s=n(this).find('input[name="password_confirm"]');(a.length&&s.length)>0&&r.on("keyup",s,function(n){var e=a.val(),i=s.val();""!=(e&&i)&&(a.val()==s.val()?a.add(s).css({"border-color":"#25f500"}):a.add(s).css({"border-color":""}))})}),l.length>0&&(r.on("focus",'input[name="password"]',function(a){n(this).closest("form").find(".password-strength").slideDown("fast")}),r.on("keyup",'input[name="password"]',function(a){var s=n(this).closest("form"),e={0:"Weak",1:"Weak",2:"Okay",3:"Good",4:"Great"},i=s.find(".password-strength-meter"),t=s.find(".password-strength-text"),m=n(this).val(),o=zxcvbn(m);i.attr("data-strength",o.score),""!==m?t.html(e[o.score]):t.html("")})),r.on("submit",'form[data-form="login"]',function(a){console.log("Login form submitted"),a.preventDefault();var s=n(this),e=s.find('button[name="submit"]'),t=e.html();s.addClass("processing"),e.prop("disabled",!0),e.html('<span class="wampum-loading"><span class="wampum-loading-circle wampum-loading-circle1">&#8226;</span><span class="wampum-loading-circle wampum-loading-circle2">&#8226;</span><span class="wampum-loading-circle wampum-loading-circle3">&#8226;</span></span>'),o(s);var r={user_login:s.find('input[name="username"]').val(),user_password:s.find('input[name="password"]').val(),remember:s.find('input[name="rememberme"]').val(),notifications:s.find('input[name="notifications"]').val(),say_what:s.find('input[name ="say_what"]').val()};n.ajax({method:"POST",url:wampumFormVars.root+"wampum/v1/login/",data:r,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampumFormVars.nonce)},success:function(a){if(1==a.success){m(s,"success","Success!");var n=s.find('input[name="redirect"]').val();""!=n&&("membership_form"==n?window.location.reload():i(n))}else m(s,"error",a.message)},fail:function(a){m(s,"error",a.failure)}}).done(function(a){s.removeClass("processing"),e.html(t).prop("disabled",!1)})}),r.on("submit",'form[data-form="password"]',function(a){console.log("Password form submitted"),a.preventDefault();var s=n(this),e=s.find('button[name="submit"]'),t=e.html();s.addClass("processing"),e.prop("disabled",!0),e.html('<span class="wampum-loading"><span class="wampum-loading-circle wampum-loading-circle1">&#8226;</span><span class="wampum-loading-circle wampum-loading-circle2">&#8226;</span><span class="wampum-loading-circle wampum-loading-circle3">&#8226;</span></span>'),o(s);var r={password:s.find('input[name="password"]').val(),password_confirm:s.find('input[name="password_confirm"]').val(),notifications:s.find('input[name="notifications"]').val(),say_what:s.find('input[name="say_what"]').val()};n.ajax({method:"POST",url:wampumFormVars.root+"wampum/v1/password/",data:r,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampumFormVars.nonce)},success:function(a){1==a.success?(m(s,"success","Success!"),i(s.find('input[name="redirect"]').val())):(s.find(".password-strength-meter").attr("data-strength",""),s.find(".password-strength-text").html(""),m(s,"error",a.message))},fail:function(a){m(s,"error",wampumFormVars.failure)}}).done(function(a){s.removeClass("processing"),e.html(t).prop("disabled",!1)})}),r.on("submit",'form[data-form="register"]',function(a){console.log("Register form submitted"),a.preventDefault();var s=n(this),e=s.find('button[name="submit"]'),t=e.html();e.prop("disabled",!0),e.html('<span class="wampum-loading"><span class="wampum-loading-circle wampum-loading-circle1">&#8226;</span><span class="wampum-loading-circle wampum-loading-circle2">&#8226;</span><span class="wampum-loading-circle wampum-loading-circle3">&#8226;</span></span>'),o(s);var r={email:s.find('input[name="email"]').val(),username:s.find('input[name="username"]').val(),first_name:s.find('input[name="first_name"]').val(),last_name:s.find('input[name="last_name"]').val(),password:s.find('input[name="password"]').val(),password_confirm:s.find('input[name="password_confirm"]').val(),log_in:s.find('input[name="log_in"]').val(),ac_list_ids:s.find('input[name="ac_list_ids"]').val(),ac_tags:s.find('input[name="ac_tags"]').val(),notifications:s.find('input[name="notifications"]').val(),say_what:s.find('input[name="say_what"]').val()};n.ajax({method:"POST",url:wampumFormVars.root+"wampum/v1/register/",data:r,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampumFormVars.nonce)},success:function(a){1==a.success?(m(s,"success","Success!"),i(s.find('input[name="redirect"]').val())):m(s,"error",a.message)},fail:function(a){m(s,"error",a.failure)}}).done(function(a){s.removeClass("processing"),e.html(t).prop("disabled",!1)})}),r.on("submit",'form[data-form="subscribe"]',function(a){console.log("Subscribe form submitted"),a.preventDefault();var s=n(this),e=s.find('button[name="submit"]'),t=e.html();e.prop("disabled",!0),e.html('<span class="wampum-loading"><span class="wampum-loading-circle wampum-loading-circle1">&#8226;</span><span class="wampum-loading-circle wampum-loading-circle2">&#8226;</span><span class="wampum-loading-circle wampum-loading-circle3">&#8226;</span></span>'),o(s);var r={email:s.find('input[name="email"]').val(),first_name:s.find('input[name="first_name"]').val(),last_name:s.find('input[name="last_name"]').val(),ac_list_ids:s.find('input[name="ac_list_ids"]').val(),ac_tags:s.find('input[name="ac_tags"]').val(),notifications:s.find('input[name="notifications"]').val(),say_what:s.find('input[name="say_what"]').val()};n.ajax({method:"POST",url:wampumFormVars.root+"wampum/v1/subscribe/",data:r,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampumFormVars.nonce)},success:function(a){1==a.success?(m(s,"success","Success!"),i(s.find('input[name="redirect"]').val())):m(s,"error",a.message)},fail:function(a){m(s,"error",a.failure)}}).done(function(a){s.removeClass("processing"),e.html(t).prop("disabled",!1)})}),r.on("submit",'form[data-form="user-available"]',function(a){console.log("User available form submitted"),a.preventDefault();var s=n(this),i=s.find('button[name="submit"]');s.addClass("processing");var t=i.html();i.prop("disabled",!0),i.html('<span class="wampum-loading"><span class="wampum-loading-circle wampum-loading-circle1">&#8226;</span><span class="wampum-loading-circle wampum-loading-circle2">&#8226;</span><span class="wampum-loading-circle wampum-loading-circle3">&#8226;</span></span>'),o(s);var r={email:s.find('input[name="email"]').val(),username:s.find('input[name="username"]').val(),say_what:s.find('input[name="say_what"]').val(),current_url:wampumFormVars.current_url};n.ajax({method:"POST",url:wampumFormVars.root+"wampum/v1/user-available/",data:r,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampumFormVars.nonce)},success:function(a){if(1==a.success){var n=s.siblings('form[data-form="join-membership"]');n.find('input[name="first_name"]').val(s.find('input[name="first_name"]').val()).prop("readonly",!0),n.find('input[name="last_name"]').val(s.find('input[name="last_name"]').val()).prop("readonly",!0),n.find('input[name="email"]').val(s.find('input[name="email"]').val()).prop("readonly",!0),n.find('input[name="username"]').val(s.find('input[name="username"]').val()).prop("readonly",!0),n.find(".first-name").hide(),n.find(".last-name").hide(),n.find(".email").hide(),n.find(".username").hide(),m(n,"success","Almost there! This is the last step."),s.fadeOut(300,function(){n.fadeIn(600),n.find('input[name="password"]').focus()})}else m(s,"error",a.message),s.on("click",".login-link",function(a){a.preventDefault(),setTimeout(function(){e(s)},300)})},fail:function(a){m(s,"error",wampumFormVars.failure)}}).done(function(a){s.removeClass("processing"),i.html(t).attr("disabled",!1)})}),r.on("submit",'form[data-form="join-membership"]',function(a){console.log("Membership form submitted"),a.preventDefault();var s=n(this),t=s.find('button[name="submit"]');s.addClass("processing");var r=t.html();t.prop("disabled",!0),t.html('<span class="wampum-loading"><span class="wampum-loading-circle wampum-loading-circle1">&#8226;</span><span class="wampum-loading-circle wampum-loading-circle2">&#8226;</span><span class="wampum-loading-circle wampum-loading-circle3">&#8226;</span></span>'),o(s);var l={plan_id:s.find('input[name="plan_id"]').val(),email:s.find('input[name="email"]').val(),first_name:s.find('input[name="first_name"]').val(),last_name:s.find('input[name="last_name"]').val(),username:s.find('input[name="username"]').val(),password:s.find('input[name="password"]').val(),log_in:s.find('input[name="log_in"]').val(),notifications:s.find('input[name="notifications"]').val(),ac_list_ids:s.find('input[name="ac_list_ids"]').val(),ac_tags:s.find('input[name="ac_tags"]').val(),notifications:s.find('input[name="notifications"]').val(),say_what:s.find('input[name="say_what"]').val(),current_url:wampumFormVars.current_url};n.ajax({method:"POST",url:wampumFormVars.root+"wampum/v1/membership-add/",data:l,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampumFormVars.nonce)},success:function(a){if(1==a.success){m(s,"success","Success!");var n=s.find('input[name="redirect"]').val();""!=n?setTimeout(function(){i(n)},300):setTimeout(function(){s.fadeOut("fast")},300)}else m(s,"error",a.message),s.on("click",".login-link",function(a){a.preventDefault(),setTimeout(function(){e($userAvailableForm)},300)})},fail:function(a){m(s,"error",wampumFormVars.failure)}}).done(function(a){s.removeClass("processing"),t.html(r).prop("disabled",!1)})})}(document,jQuery);