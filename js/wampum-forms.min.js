!function(a,n,e){"use strict";function i(a){t(a);var n=a.siblings('form[data-form="login"]');a.fadeOut(300,function(){n.fadeIn(600)}),n.find('input[name="username"]').val(a.find('input[name="email"]').val()),n.find('input[name="password"]').focus(),n.find(".wampum-back").remove(),n.find('button[name="submit"]').after('<a class="wampum-back" href="#">&nbsp;&nbsp;Go back</a>'),n.on("click",".wampum-back",function(e){e.preventDefault(),n.fadeOut(300,function(){a.fadeIn(600)}),n.find('input[name="password"]').val("")})}function s(a,n,e){a.find(".wampum-notice").removeClass("success error").addClass(n).html(e).fadeIn("fast")}function t(a){a.find(".wampum-notice").slideUp("fast",function(){n(this).removeClass("success error")})}function o(){return'<span class="wampum-loading"><span class="wampum-loading-circle wampum-loading-circle1">&#8226;</span><span class="wampum-loading-circle wampum-loading-circle2">&#8226;</span><span class="wampum-loading-circle wampum-loading-circle3">&#8226;</span></span>'}var r=n(".wampum-form"),m=n(".password-strength-meter");n.each(r,function(){var a=n(this).find('input[name="password"]'),e=n(this).find('input[name="password_confirm"]');(a.length&&e.length)>0&&r.on("keyup",e,function(n){var i=a.val(),s=e.val();""!=(i&&s)&&(a.val()==e.val()?a.add(e).css({"border-color":"#25f500"}):a.add(e).css({"border-color":""}))})}),m.length>0&&(r.on("focus",'input[name="password"]',function(a){n(this).closest("form").find(".password-strength").slideDown("fast")}),r.on("keyup",'input[name="password"]',function(a){var e=n(this).closest("form"),i={0:"Weak",1:"Weak",2:"Okay",3:"Good",4:"Great"},s=e.find(".password-strength-meter"),t=e.find(".password-strength-text"),o=n(this).val(),r=zxcvbn(o);s.attr("data-strength",r.score),""!==o?t.html(i[r.score]):t.html("")})),r.on("submit",'form[data-form="login"]',function(a){console.log("Login form submitted"),a.preventDefault();var e=n(this),i=e.find('button[name="submit"]'),r=i.html();e.addClass("processing"),i.prop("disabled",!0),i.html(o()),t(e);var m={user_login:e.find('input[name="username"]').val(),user_password:e.find('input[name="password"]').val(),remember:e.find('input[name="rememberme"]').val(),notifications:e.find('input[name="notifications"]').val(),say_what:e.find('input[name="say_what"]').val()};n.ajax({method:"POST",url:wampumFormVars.root+"wampum/v1/login/",data:m,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampumFormVars.nonce)},success:function(a){if(1==a.success){s(e,"success","Success!");var n=e.find('input[name="redirect"]').val();""!=n&&("membership_form"==n?window.location.reload():window.location.replace(n))}else s(e,"error",a.message)},fail:function(a){s(e,"error",a.failure)}}).done(function(a){e.removeClass("processing"),i.html(r).prop("disabled",!1)})}),r.on("submit",'form[data-form="password"]',function(a){console.log("Password form submitted"),a.preventDefault();var e=n(this),i=e.find('button[name="submit"]'),r=i.html();e.addClass("processing"),i.prop("disabled",!0),i.html(o()),t(e);var m={password:e.find('input[name="password"]').val(),password_confirm:e.find('input[name="password_confirm"]').val(),notifications:e.find('input[name="notifications"]').val(),say_what:e.find('input[name="say_what"]').val()};n.ajax({method:"POST",url:wampumFormVars.root+"wampum/v1/password/",data:m,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampumFormVars.nonce)},success:function(a){if(1==a.success){s(e,"success","Success!");var n=e.find('input[name="redirect"]').val();window.location.replace(n)}else e.find(".password-strength-meter").attr("data-strength",""),e.find(".password-strength-text").html(""),s(e,"error",a.message)},fail:function(a){s(e,"error",wampumFormVars.failure)}}).done(function(a){e.removeClass("processing"),i.html(r).prop("disabled",!1)})}),r.on("submit",'form[data-form="register"]',function(a){console.log("Register form submitted"),a.preventDefault();var e=n(this),i=e.find('button[name="submit"]'),r=i.html();i.prop("disabled",!0),i.html(o()),t(e);var m={email:e.find('input[name="email"]').val(),username:e.find('input[name="username"]').val(),first_name:e.find('input[name="first_name"]').val(),last_name:e.find('input[name="last_name"]').val(),password:e.find('input[name="password"]').val(),password_confirm:e.find('input[name="password_confirm"]').val(),log_in:e.find('input[name="log_in"]').val(),ac_list_ids:e.find('input[name="ac_list_ids"]').val(),ac_tags:e.find('input[name="ac_tags"]').val(),notifications:e.find('input[name="notifications"]').val(),say_what:e.find('input[name="say_what"]').val()};n.ajax({method:"POST",url:wampumFormVars.root+"wampum/v1/register/",data:m,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampumFormVars.nonce)},success:function(a){if(1==a.success){s(e,"success","Success!");var n=e.find('input[name="redirect"]').val();window.location.replace(n)}else s(e,"error",a.message)},fail:function(a){s(e,"error",a.failure)}}).done(function(a){e.removeClass("processing"),i.html(r).prop("disabled",!1)})}),r.on("submit",'form[data-form="subscribe"]',function(a){console.log("Subscribe form submitted"),a.preventDefault();var e=n(this),i=e.find('button[name="submit"]'),r=i.html();i.prop("disabled",!0),i.html(o()),t(e);var m={email:e.find('input[name="email"]').val(),first_name:e.find('input[name="first_name"]').val(),last_name:e.find('input[name="last_name"]').val(),ac_list_ids:e.find('input[name="ac_list_ids"]').val(),ac_tags:e.find('input[name="ac_tags"]').val(),notifications:e.find('input[name="notifications"]').val(),say_what:e.find('input[name="say_what"]').val()};n.ajax({method:"POST",url:wampumFormVars.root+"wampum/v1/subscribe/",data:m,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampumFormVars.nonce)},success:function(a){if(1==a.success){s(e,"success","Success!");var n=e.find('input[name="redirect"]').val();window.location.replace(n)}else s(e,"error",a.message)},fail:function(a){s(e,"error",a.failure)}}).done(function(a){e.removeClass("processing"),i.html(r).prop("disabled",!1)})}),r.on("submit",'form[data-form="user-available"]',function(a){console.log("User available form submitted"),a.preventDefault();var e=n(this),r=e.find('button[name="submit"]');e.addClass("processing");var m=r.html();r.prop("disabled",!0),r.html(o()),t(e);var u={email:e.find('input[name="email"]').val(),username:e.find('input[name="username"]').val(),say_what:e.find('input[name="say_what"]').val(),current_url:wampumFormVars.current_url};n.ajax({method:"POST",url:wampumFormVars.root+"wampum/v1/user-available/",data:u,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampumFormVars.nonce)},success:function(a){if(1==a.success){var n=e.siblings('form[data-form="join-membership"]');n.find('input[name="first_name"]').val(e.find('input[name="first_name"]').val()).prop("readonly",!0),n.find('input[name="last_name"]').val(e.find('input[name="last_name"]').val()).prop("readonly",!0),n.find('input[name="email"]').val(e.find('input[name="email"]').val()).prop("readonly",!0),n.find('input[name="username"]').val(e.find('input[name="username"]').val()).prop("readonly",!0),n.find(".first-name").hide(),n.find(".last-name").hide(),n.find(".email").hide(),n.find(".username").hide(),s(n,"success","Almost there! This is the last step."),e.fadeOut(300,function(){n.fadeIn(600),n.find('input[name="password"]').focus()})}else s(e,"error",a.message),e.on("click",".login-link",function(a){a.preventDefault(),setTimeout(function(){i(e)},300)})},fail:function(a){s(e,"error",wampumFormVars.failure)}}).done(function(a){e.removeClass("processing"),r.html(m).attr("disabled",!1)})}),r.on("submit",'form[data-form="join-membership"]',function(a){console.log("Membership form submitted"),a.preventDefault();var e=n(this),r=e.find('button[name="submit"]');e.addClass("processing");var m=r.html();r.prop("disabled",!0),r.html(o()),t(e);var u={plan_id:e.find('input[name="plan_id"]').val(),email:e.find('input[name="email"]').val(),first_name:e.find('input[name="first_name"]').val(),last_name:e.find('input[name="last_name"]').val(),username:e.find('input[name="username"]').val(),password:e.find('input[name="password"]').val(),log_in:e.find('input[name="log_in"]').val(),notifications:e.find('input[name="notifications"]').val(),ac_list_ids:e.find('input[name="ac_list_ids"]').val(),ac_tags:e.find('input[name="ac_tags"]').val(),notifications:e.find('input[name="notifications"]').val(),say_what:e.find('input[name="say_what"]').val(),current_url:wampumFormVars.current_url};n.ajax({method:"POST",url:wampumFormVars.root+"wampum/v1/membership-add/",data:u,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampumFormVars.nonce)},success:function(a){if(1==a.success){s(e,"success","Success!");var n=e.find('input[name="redirect"]').val();""!=n?setTimeout(function(){window.location.replace(n)},300):setTimeout(function(){e.fadeOut("fast")},300)}else s(e,"error",a.message),e.on("click",".login-link",function(a){a.preventDefault(),setTimeout(function(){i($userAvailableForm)},300)})},fail:function(a){s(e,"error",wampumFormVars.failure)}}).done(function(a){e.removeClass("processing"),r.html(m).prop("disabled",!1)})})}(document,jQuery);