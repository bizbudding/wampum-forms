!function(a){"use strict";function e(a){m(a);var e=a.siblings(".wampum-user-login-form");a.hide(),e.show(),e.find(".wampum_user_login").val(a.find(".wampum_email").val()),e.find(".wampum-back").remove(),e.find(".wampum_submit").after('<a class="wampum-back" href="#">&nbsp;&nbsp;Go back</a>'),e.on("click",".wampum-back",function(s){s.preventDefault(),e.hide(),a.show(),e.find(".wampum_user_pass").val("")})}function s(a,e,s){a.find(".wampum-notice").removeClass("success, error").addClass(e).html(s).fadeIn("fast")}function m(e){e.find(".wampum-notice").slideUp("fast",function(){a(this).removeClass("success, error")})}function r(){return'<div class="wampum-loading"><div class="wampum-loading-circle wampum-loading-circle1">&#8226;</div><div class="wampum-loading-circle wampum-loading-circle2">&#8226;</div><div class="wampum-loading-circle wampum-loading-circle3">&#8226;</div></div>'}a(".wampum-form").on("focus",".wampum_password",function(e){a(this).closest("form").find(".password-strength").slideDown("fast")}),a(".wampum-form").on("keyup",".wampum_password",function(e){var s=a(this).closest("form"),m={0:"Weak",1:"Weak",2:"Okay",3:"Good",4:"Great"},r=s.find(".password-strength-meter"),n=s.find(".password-strength-text"),i=a(this).val(),t=zxcvbn(i);r.attr("data-strength",t.score),""!==i?n.html(m[t.score]):n.html("")}),a("body").on("submit",".wampum-user-login-form",function(e){console.log("Login form submitted"),e.preventDefault();var n=a(this);n.addClass("processing");var i=n.find(".wampum_submit"),t=i.html();i.attr("disabled",!0),i.html(r()),m(n);var o={user_login:n.find(".wampum_user_login").val(),user_password:n.find(".wampum_user_pass").val(),remember:n.find(".wampum_rememberme").val(),say_what:n.find(".wampum_say_what").val()};a.ajax({method:"POST",url:wampum_user_forms.root+"wampum/v1/login/",data:o,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampum_user_forms.nonce)},success:function(a){if(1==a.success){s(n,"success","Success!");var e=n.find(".wampum_redirect").val();""!==e&&("membership_form"==e?window.location.reload():window.location.replace(e))}else s(n,"error",a.message)},fail:function(a){s(n,"error",a.failure)}}).done(function(a){n.removeClass("processing"),i.html(t).attr("disabled",!1)})}),a("body").on("submit",".wampum-user-register-form",function(e){console.log("Register form submitted"),e.preventDefault();var n=a(this);n.addClass("processing");var i=n.find(".wampum_submit"),t=i.html();i.attr("disabled",!0),i.html(r()),m(n);var o={user_email:n.find(".wampum_user_email").val(),username:n.find(".wampum_user_login").val(),first_name:n.find(".wampum_first_name").val(),last_name:n.find(".wampum_last_name").val(),password:n.find(".wampum_user_pass").val(),log_in:n.find(".wampum_log_in").val(),list_id:n.find(".wampum_ac_list_id").val(),say_what:n.find(".wampum_say_what").val()};a.ajax({method:"POST",url:wampum_user_forms.root+"wampum/v1/register/",data:o,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampum_user_forms.nonce)},success:function(a){if(1==a.success){s(n,"success","Success!");var e=n.find(".wampum_redirect").val();""!==e&&window.location.replace(e)}else s(n,"error",a.message)},fail:function(a){s(n,"error",a.failure)}}).done(function(a){n.removeClass("processing"),i.html(t).attr("disabled",!1)})}),a("body").on("submit",".wampum-user-password-form",function(e){console.log("Password form submitted"),e.preventDefault();var n=a(this);n.addClass("processing");var i=n.find(".wampum_submit"),t=i.html();i.attr("disabled",!0),i.html(r()),m(n);var o={password:n.find(".wampum_password").val(),password_confirm:n.find(".wampum_password_confirm").val(),say_what:n.find(".wampum_say_what").val()};a.ajax({method:"POST",url:wampum_user_forms.root+"wampum/v1/password/",data:o,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampum_user_forms.nonce)},success:function(a){if(1==a.success){n.find("input:password").val(""),s(n,"success","Success!");var e=n.find(".wampum_redirect").val();window.location.replace(e)}else s(n,"error",a.message)},fail:function(a){s(n,"error",wampum_user_forms.failure)}}).done(function(a){n.removeClass("processing"),n.find(".password-strength-meter").attr("data-strength",""),n.find(".password-strength-text").html(""),i.html(t).attr("disabled",!1)})}),a("body").on("submit",".wampum-user-membership-form-verify",function(n){n.preventDefault();var i=a(this);i.addClass("processing");var t=i.find(".wampum_submit"),o=t.html();t.attr("disabled",!0),t.html(r()),m(i);var u={say_what:i.find('[name="wampum_say_what"]').val(),user_email:i.find('[name="wampum_membership_email"]').val(),username:i.find('[name="wampum_membership_username"]').val(),current_url:wampum_user_forms.current_url},l=i.find(".wampum_ss_baseuri").val(),d=i.find(".wampum_ss_endpoint").val(),f=i.serialize();l&&d&&i.after('<script type="text/javascript">var __ss_noform = __ss_noform || [];</script>'),a.ajax({method:"POST",url:wampum_user_forms.root+"wampum/v1/membership-verify/",data:u,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampum_user_forms.nonce)},success:function(m){if(1==m.success){l&&d&&a.ajax({url:l+d+"/jsonp/?"+f,contentType:"application/json",dataType:"jsonp",success:function(a){console.log("Data successfully sent to SharpSpring.")}});var r=i.siblings(".wampum-user-membership-form");r.find(".wampum_first_name").val(i.find(".wampum_first_name").val()).attr("readonly",!0),r.find(".wampum_last_name").val(i.find(".wampum_last_name").val()).attr("readonly",!0),r.find(".wampum_email").val(i.find(".wampum_email").val()).attr("readonly",!0),r.find(".wampum_username").val(i.find(".wampum_username").val()).attr("readonly",!0),r.find(".membership-first-name").hide(),r.find(".membership-last-name").hide(),r.find(".membership-email").hide(),r.find(".membership-username").hide(),s(r,"success","Almost there! This is the last step."),i.hide(),r.show(),r.find(".wampum_password").focus()}else s(i,"error",m.message),i.on("click",".login-link",function(a){a.preventDefault(),setTimeout(function(){e(i)},300)})},fail:function(a){s(i,"error",wampum_user_forms.failure)}}).done(function(a){i.removeClass("processing"),t.html(o).attr("disabled",!1)})}),a("body").on("submit",".wampum-user-membership-form",function(n){console.log("Membership form submitted"),n.preventDefault();var i=a(this);i.addClass("processing");var t=i.find(".wampum_submit"),o=t.html();t.attr("disabled",!0),t.html(r()),m(i);var u={plan_id:i.find(".wampum_plan_id").val(),first_name:i.find(".wampum_first_name").val(),last_name:i.find(".wampum_last_name").val(),user_email:i.find(".wampum_email").val(),username:i.find(".wampum_username").val(),password:i.find(".wampum_password").val(),notifications:i.find(".wampum_notifications").val(),say_what:i.find(".wampum_say_what").val(),current_url:wampum_user_forms.current_url},l=i.find(".wampum_ss_baseuri").val(),d=i.find(".wampum_ss_endpoint").val(),f=a("input[type!=password]",i).serialize();l&&d&&i.after('<script type="text/javascript">var __ss_noform = __ss_noform || [];</script>'),a.ajax({method:"POST",url:wampum_user_forms.root+"wampum/v1/membership-add/",data:u,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampum_user_forms.nonce)},success:function(m){if(1==m.success){l&&d&&a.ajax({url:l+d+"/jsonp/?"+f,contentType:"application/json",dataType:"jsonp",success:function(a){console.log("Data successfully sent to SharpSpring.")}}),s(i,"success","Success!");var r=i.find(".wampum_redirect").val();""!==r?setTimeout(function(){window.location.replace(r)},300):setTimeout(function(){i.fadeOut("fast")},300)}else s(i,"error",m.message),i.on("click",".login-link",function(a){a.preventDefault(),setTimeout(function(){e(MembershipVerify)},300)})},fail:function(a){s(i,"error",wampum_user_forms.failure)}}).done(function(a){i.removeClass("processing"),t.html(o).attr("disabled",!1)})})}(jQuery);