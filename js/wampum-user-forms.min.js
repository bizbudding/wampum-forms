!function(a){"use strict";function b(a){d(a);var b=a.siblings(".wampum-user-login-form");a.hide(),b.show(),b.find(".wampum_user_login").val(a.find(".wampum_email").val()),b.find(".wampum-back").remove(),b.find(".wampum_submit").after('<a class="wampum-back" href="#">&nbsp;&nbsp;Go back</a>'),b.on("click",".wampum-back",function(c){c.preventDefault(),b.hide(),a.show(),b.find(".wampum_user_pass").val("")})}function c(a,b,c){a.find(".wampum-notice").removeClass("success, error").addClass(b).html(c).fadeIn("fast")}function d(b){b.find(".wampum-notice").slideUp("fast",function(){a(this).removeClass("success, error")})}function e(){return'<div class="wampum-loading"><div class="wampum-loading-circle wampum-loading-circle1">&#8226;</div><div class="wampum-loading-circle wampum-loading-circle2">&#8226;</div><div class="wampum-loading-circle wampum-loading-circle3">&#8226;</div></div>'}a(".wampum-form").on("focus",".wampum_password",function(b){a(this).closest("form").find(".password-strength").slideDown("fast")}),a(".wampum-form").on("keyup",".wampum_password",function(b){var c=a(this).closest("form"),d={0:"Weak",1:"Weak",2:"Okay",3:"Good",4:"Great"},e=c.find(".password-strength-meter"),f=c.find(".password-strength-text"),g=a(this).val(),h=zxcvbn(g);e.attr("data-strength",h.score),""!==g?f.html(d[h.score]):f.html("")}),a("body").on("submit",".wampum-user-login-form",function(b){console.log("Login form submitted"),b.preventDefault();var f=a(this);f.addClass("processing");var g=f.find(".wampum_submit"),h=g.html();g.attr("disabled",!0),g.html(e()),d(f);var i={user_login:f.find(".wampum_user_login").val(),user_password:f.find(".wampum_user_pass").val(),remember:f.find(".wampum_rememberme").val(),say_what:f.find(".wampum_say_what").val()};a.ajax({method:"POST",url:wampum_user_forms.root+"wampum/v1/login/",data:i,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampum_user_forms.nonce)},success:function(a){if(1==a.success){c(f,"success","Success!");var b=f.find(".wampum_redirect").val();""!==b&&("membership_form"==b?window.location.reload():window.location.replace(b))}else c(f,"error",a.message)},fail:function(a){c(f,"error",a.failure)}}).done(function(a){f.removeClass("processing"),g.html(h).attr("disabled",!1)})}),a("body").on("submit",".wampum-user-password-form",function(b){console.log("Password form submitted"),b.preventDefault();var f=a(this);f.addClass("processing");var g=f.find(".wampum_submit"),h=g.html();g.attr("disabled",!0),g.html(e()),d(f);var i={password:f.find(".wampum_password").val(),password_confirm:f.find(".wampum_password_confirm").val(),say_what:f.find(".wampum_say_what").val()};a.ajax({method:"POST",url:wampum_user_forms.root+"wampum/v1/password/",data:i,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampum_user_forms.nonce)},success:function(a){if(1==a.success){f.find("input:password").val(""),c(f,"success","Success!");var b=f.find(".wampum_redirect").val();window.location.replace(b)}else c(f,"error",a.message)},fail:function(a){c(f,"error",wampum_user_forms.failure)}}).done(function(a){f.removeClass("processing"),f.find(".password-strength-meter").attr("data-strength",""),f.find(".password-strength-text").html(""),g.html(h).attr("disabled",!1)})}),a("body").on("submit",".wampum-user-membership-form-verify",function(f){f.preventDefault();var g=a(this);g.addClass("processing");var h=g.find(".wampum_submit"),i=h.html();h.attr("disabled",!0),h.html(e()),d(g);var j={say_what:g.find('[name="wampum_say_what"]').val(),user_email:g.find('[name="wampum_membership_email"]').val(),username:g.find('[name="wampum_membership_username"]').val(),current_url:wampum_user_forms.current_url},k=g.find(".wampum_ss_baseuri").val(),l=g.find(".wampum_ss_endpoint").val(),m=g.serialize();k&&l&&g.after('<script type="text/javascript">var __ss_noform = __ss_noform || [];</script>'),a.ajax({method:"POST",url:wampum_user_forms.root+"wampum/v1/membership-verify/",data:j,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampum_user_forms.nonce)},success:function(d){if(1==d.success){k&&l&&a.ajax({url:k+l+"/jsonp/?"+m,contentType:"application/json",dataType:"jsonp",success:function(a){console.log("Data successfully sent to SharpSpring.")}});var e=g.siblings(".wampum-user-membership-form");e.find(".wampum_first_name").val(g.find(".wampum_first_name").val()).attr("readonly",!0),e.find(".wampum_last_name").val(g.find(".wampum_last_name").val()).attr("readonly",!0),e.find(".wampum_email").val(g.find(".wampum_email").val()).attr("readonly",!0),e.find(".membership-first-name").hide(),e.find(".membership-last-name").hide(),e.find(".membership-email").hide(),c(e,"success","Almost there! This is the last step."),g.hide(),e.show()}else c(g,"error",d.message),g.on("click",".login-link",function(a){a.preventDefault(),setTimeout(function(){b(g)},300)})},fail:function(a){c(g,"error",wampum_user_forms.failure)}}).done(function(a){g.removeClass("processing"),h.html(i).attr("disabled",!1)})}),a("body").on("submit",".wampum-user-membership-form",function(f){console.log("Membership form submitted"),f.preventDefault();var g=a(this);g.addClass("processing");var h=g.find(".wampum_submit"),i=h.html();h.attr("disabled",!0),h.html(e()),d(g);var j={plan_id:g.find(".wampum_plan_id").val(),first_name:g.find(".wampum_first_name").val(),last_name:g.find(".wampum_last_name").val(),user_email:g.find(".wampum_email").val(),username:g.find(".wampum_username").val(),password:g.find(".wampum_password").val(),notifications:g.find(".wampum_notifications").val(),say_what:g.find(".wampum_say_what").val(),current_url:wampum_user_forms.current_url},k=g.find(".wampum_ss_baseuri").val(),l=g.find(".wampum_ss_endpoint").val(),m=a("input[type!=password]",g).serialize();k&&l&&g.after('<script type="text/javascript">var __ss_noform = __ss_noform || [];</script>'),a.ajax({method:"POST",url:wampum_user_forms.root+"wampum/v1/membership-add/",data:j,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wampum_user_forms.nonce)},success:function(d){if(1==d.success){k&&l&&a.ajax({url:k+l+"/jsonp/?"+m,contentType:"application/json",dataType:"jsonp",success:function(a){console.log("Data successfully sent to SharpSpring.")}}),c(g,"success","Success!");var e=g.find(".wampum_redirect").val();""!==e?setTimeout(function(){window.location.replace(e)},300):setTimeout(function(){g.fadeOut("fast")},300)}else c(g,"error",d.message),g.on("click",".login-link",function(a){a.preventDefault(),setTimeout(function(){b(MembershipVerify)},300)})},fail:function(a){c(g,"error",wampum_user_forms.failure)}}).done(function(a){g.removeClass("processing"),h.html(i).attr("disabled",!1)})})}(jQuery);